<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/google-map/google-map.html">
<link rel="import" href="../bower_components/google-map/google-map-marker.html">
<link rel="import" href="../src/elements.html">

<dom-module id="sportal-map">

    <template>

        <style>
            :host {
                display: block;
            }

            google-map {
               height: 100vh;
               width: 100%;

            }

            .map-container {
                display: flex;
                flex-direction: row;
            }

            #filter-container {
                flex: 1 0 0;
                z-index: 1;
                padding-left: 10px;
                background-color: var(--light-sportal-blue);
            }

            #map-area {
                flex: 6 0 0;
            }

        </style>

        <paper-card class="map-container">
            <div elevation="1" id="filter-container">
                <h4>Filters:</h4>
                <h5>Event Type</h5>
                <h5>Sport</h5>
                <h5>Location</h5>
                <h5>Skill Level</h5>
                <h5>Age</h5>
                <template is="dom-repeat" items="{{ajax}}">
                    <h5>{{item.address.lng}}</h5>
                </template>
            </div>

            <div id="map-area">
                <google-map fit-to-markers
                            single-info-window=true
                            zoom=10>
                    <template is="dom-repeat" items="{{ajax}}">
                        <google-map-marker latitude="{{item.address.lat}}"
                                           longitude="{{item.address.lng}}">
                        </google-map-marker>
                    </template>
                </google-map>
            </div>
        </paper-card>

        <iron-ajax id="eventGet"
                   auto
                   url="http://localhost:3000/api/Events"
                   handle-as="json"
                   on-response="_onResponse"
                   on-error="_onError"
                   content-type="application/json"
                   debounce-duration="500"
                   method="GET"
        ></iron-ajax>

    </template>

    <script>

        Polymer({

            is: 'sportal-map',

            properties: {

                route: Object,

                ajax: {
                    type: Object
                }

            },

            _onResponse: function (data) {
                this.ajax = data.detail.response;
                console.log(this.ajax);
                console.log(this.ajax[0].address.lat);
                console.log(this.ajax[0].address.lng);
            },

            _onError: function (e) {

            }
        });

    </script>

</dom-module>